# J-Quants API 設定ガイド

## 1. J-Quantsアカウント作成

1. [J-Quants公式サイト](https://jpx-jquants.com/) にアクセス
2. 「新規登録」でアカウント作成
3. メール認証を完了

## 2. APIキー取得

1. ログイン後、マイページへ
2. 「API」セクションでAPIキーを生成
3. 無料プランでは1日1,000リクエストまで利用可能

## 3. 環境変数設定

### ローカル開発
`.env.local` ファイルにAPIキーを設定：
```
JQUANTS_API_KEY=your_actual_api_key_here
```

### Vercelデプロイ
1. Vercelダッシュボードで該当プロジェクトを選択
2. Settings → Environment Variables
3. `JQUANTS_API_KEY` を追加
4. 本番用APIキーを設定

## 4. 利用可能な銘柄コード

J-Quantsでは以下の形式で銘柄コードを指定：
- トヨタ自動車: `7203`
- ソフトバンクグループ: `9984`
- 任天堂: `7974`
- ソニー: `6758`

## 5. API制限と注意事項

- **無料プラン**: 1日1,000リクエスト
- **有料プラン**: より多くのリクエストと詳細データ
- **レート制限**: 1秒間に複数リクエストは避ける
- **キャッシュ**: アプリ内で6時間キャッシュして制限を節約

## 6. フォールバック機能

APIキーが未設定またはエラーの場合：
- 自動的にモックデータにフォールバック
- エラーログを出力
- サービス継続可能

## 7. 取得可能データ

### 株価データ
- 日次株価（始値、高値、安値、終値、出来高）
- 調整後株価（株式分割等に対応）
- 過去30日分のデータ

### 企業情報
- 銘柄名
- 業種分類
- 市場区分

### 財務データ（有料プランで詳細利用可能）
- PER, PBR, ROE
- 配当利回り
- 時価総額
- 売上高

## 8. トラブルシューティング

### よくあるエラー
1. **401 Unauthorized**: APIキーが間違っている
2. **403 Forbidden**: APIクォータ超過
3. **404 Not Found**: 存在しない銘柄コード
4. **429 Too Many Requests**: レート制限に引っかかった

### 対処法
- APIキーを確認
- 銘柄コードの形式確認（4桁数字）
- リクエスト頻度を調整
- キャッシュの活用